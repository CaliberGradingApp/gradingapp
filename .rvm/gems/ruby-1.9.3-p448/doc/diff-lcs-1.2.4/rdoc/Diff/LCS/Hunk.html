<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Diff::LCS::Hunk - diff-lcs-1.2.4 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/diff/lcs/hunk.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Object
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-i-diff">#diff</a>
    
    <li><a href="#method-i-merge">#merge</a>
    
    <li><a href="#method-i-overlaps-3F">#overlaps?</a>
    
    <li><a href="#method-i-unshift">#unshift</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../../Contributing_rdoc.html">Contributing</a>
  
    <li class="file"><a href="../../History_rdoc.html">History</a>
  
    <li class="file"><a href="../../License_rdoc.html">License</a>
  
    <li class="file"><a href="../../Manifest_txt.html">Manifest</a>
  
    <li class="file"><a href="../../README_rdoc.html">README</a>
  
    <li class="file"><a href="../../docs/COPYING_txt.html">COPYING</a>
  
    <li class="file"><a href="../../docs/artistic_txt.html">artistic</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../Diff.html">Diff</a>
  
    <li><a href="../../Diff/LCS.html">Diff::LCS</a>
  
    <li><a href="../../Diff/LCS/DefaultCallbacks.html">Diff::LCS::BalancedCallbacks</a>
  
    <li><a href="../../Diff/LCS/Block.html">Diff::LCS::Block</a>
  
    <li><a href="../../Diff/LCS/Change.html">Diff::LCS::Change</a>
  
    <li><a href="../../Diff/LCS/ContextChange.html">Diff::LCS::ContextChange</a>
  
    <li><a href="../../Diff/LCS/ContextDiffCallbacks.html">Diff::LCS::ContextDiffCallbacks</a>
  
    <li><a href="../../Diff/LCS/DefaultCallbacks.html">Diff::LCS::DefaultCallbacks</a>
  
    <li><a href="../../Diff/LCS/DiffCallbacks.html">Diff::LCS::DiffCallbacks</a>
  
    <li><a href="../../Diff/LCS/HTMLDiff.html">Diff::LCS::HTMLDiff</a>
  
    <li><a href="../../Diff/LCS/HTMLDiff/Callbacks.html">Diff::LCS::HTMLDiff::Callbacks</a>
  
    <li><a href="../../Diff/LCS/Hunk.html">Diff::LCS::Hunk</a>
  
    <li><a href="../../Diff/LCS/Ldiff.html">Diff::LCS::Ldiff</a>
  
    <li><a href="../../Diff/LCS/SDiffCallbacks.html">Diff::LCS::SDiffCallbacks</a>
  
    <li><a href="../../Diff/LCS/DefaultCallbacks.html">Diff::LCS::SequenceCallbacks</a>
  
    <li><a href="../../Array.html">Array</a>
  
    <li><a href="../../String.html">String</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Diff::LCS::Hunk</h1>

  <div id="description" class="description">
    
<p>A <a href="Hunk.html">Hunk</a> is a group of Blocks which overlap because
of the context surrounding each block. (So if weâ€™re not using context,
every hunk will contain one block.) Used in the diff program (bin/diff).</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-blocks" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">blocks</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-end_new" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">end_new</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-end_old" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">end_old</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-file_length_difference" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">file_length_difference</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-flag_context" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">flag_context</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="Change.html">Change</a> the "start" and "end" fields to note that
context should be added to this hunk.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-start_new" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">start_new</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-start_old" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">start_old</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(data_old, data_new, piece, flag_context, file_length_difference)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Create a hunk using references to both the old and new data, as well as the
piece of data.</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/diff/lcs/hunk.rb, line 10</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">data_old</span>, <span class="ruby-identifier">data_new</span>, <span class="ruby-identifier">piece</span>, <span class="ruby-identifier">flag_context</span>, <span class="ruby-identifier">file_length_difference</span>)
  <span class="ruby-comment"># At first, a hunk will have just one Block in it</span>
  <span class="ruby-ivar">@blocks</span> = [ <span class="ruby-constant">Diff</span><span class="ruby-operator">::</span><span class="ruby-constant">LCS</span><span class="ruby-operator">::</span><span class="ruby-constant">Block</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">piece</span>) ]
  <span class="ruby-keyword">if</span> <span class="ruby-constant">String</span>.<span class="ruby-identifier">method_defined?</span>(<span class="ruby-value">:encoding</span>)
    <span class="ruby-ivar">@preferred_data_encoding</span> = <span class="ruby-identifier">data_old</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">data_new</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">0</span>,<span class="ruby-string">''</span>) ).<span class="ruby-identifier">encoding</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@data_old</span> = <span class="ruby-identifier">data_old</span>
  <span class="ruby-ivar">@data_new</span> = <span class="ruby-identifier">data_new</span>

  <span class="ruby-identifier">before</span> = <span class="ruby-identifier">after</span> = <span class="ruby-identifier">file_length_difference</span>
  <span class="ruby-identifier">after</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@blocks</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">diff_size</span>
  <span class="ruby-ivar">@file_length_difference</span> = <span class="ruby-identifier">after</span> <span class="ruby-comment"># The caller must get this manually</span>

  <span class="ruby-comment"># Save the start &amp; end of each array. If the array doesn't exist (e.g.,</span>
  <span class="ruby-comment"># we're only adding items in this block), then figure out the line</span>
  <span class="ruby-comment"># number based on the line number of the other file and the current</span>
  <span class="ruby-comment"># difference in file lengths.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@blocks</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">remove</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">a1</span> = <span class="ruby-identifier">a2</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">a1</span> = <span class="ruby-ivar">@blocks</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">remove</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">position</span>
    <span class="ruby-identifier">a2</span> = <span class="ruby-ivar">@blocks</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">remove</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">position</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@blocks</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">insert</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">b1</span> = <span class="ruby-identifier">b2</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">b1</span> = <span class="ruby-ivar">@blocks</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">insert</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">position</span>
    <span class="ruby-identifier">b2</span> = <span class="ruby-ivar">@blocks</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">insert</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">position</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@start_old</span> = <span class="ruby-identifier">a1</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">b1</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">before</span>)
  <span class="ruby-ivar">@start_new</span> = <span class="ruby-identifier">b1</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">a1</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">before</span>)
  <span class="ruby-ivar">@end_old</span>   = <span class="ruby-identifier">a2</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">b2</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">after</span>)
  <span class="ruby-ivar">@end_new</span>   = <span class="ruby-identifier">b2</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">a2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">after</span>)

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">flag_context</span> = <span class="ruby-identifier">flag_context</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-diff" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">diff</span><span
            class="method-args">(format)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns a diff string based on a format.</p>
          

          
          <div class="method-source-code" id="diff-source">
            <pre><span class="ruby-comment"># File lib/diff/lcs/hunk.rb, line 97</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">diff</span>(<span class="ruby-identifier">format</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">format</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:old</span>
    <span class="ruby-identifier">old_diff</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:unified</span>
    <span class="ruby-identifier">unified_diff</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:context</span>
    <span class="ruby-identifier">context_diff</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:ed</span>
    <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:reverse_ed</span>, <span class="ruby-value">:ed_finish</span>
    <span class="ruby-identifier">ed_diff</span>(<span class="ruby-identifier">format</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Unknown diff format #{format}.&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- diff-source -->
          
        </div>

        

        
      </div><!-- diff-method -->

    
      <div id="method-i-merge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">merge</span><span
            class="method-args">(hunk)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Merges this hunk and the provided hunk together if they overlap. Returns a
truthy value so that if there is no overlap, you can know the merge was
skipped.</p>
          

          
          <div class="method-source-code" id="merge-source">
            <pre><span class="ruby-comment"># File lib/diff/lcs/hunk.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">hunk</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">overlaps?</span>(<span class="ruby-identifier">hunk</span>)
    <span class="ruby-ivar">@start_old</span> = <span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">start_old</span>
    <span class="ruby-ivar">@start_new</span> = <span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">start_new</span>
    <span class="ruby-identifier">blocks</span>.<span class="ruby-identifier">unshift</span>(*<span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">blocks</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- merge-source -->
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Hunk.html#method-i-unshift">unshift</a>
        </div>
        

        
      </div><!-- merge-method -->

    
      <div id="method-i-overlaps-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">overlaps?</span><span
            class="method-args">(hunk)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Determines whether there is an overlap between this hunk and the provided
hunk. This will be true if the difference between the two hunks start or
end positions is within one position of each other.</p>
          

          
          <div class="method-source-code" id="overlaps-3F-source">
            <pre><span class="ruby-comment"># File lib/diff/lcs/hunk.rb, line 91</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">overlaps?</span>(<span class="ruby-identifier">hunk</span>)
  <span class="ruby-identifier">hunk</span> <span class="ruby-keyword">and</span> (((<span class="ruby-ivar">@start_old</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">end_old</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-value">1</span>) <span class="ruby-keyword">or</span>
            ((<span class="ruby-ivar">@start_new</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">hunk</span>.<span class="ruby-identifier">end_new</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-value">1</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- overlaps-3F-source -->
          
        </div>

        

        
      </div><!-- overlaps-3F-method -->

    
      <div id="method-i-unshift" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">unshift</span><span
            class="method-args">(hunk)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Hunk.html#method-i-merge">merge</a>
        </div>
        
      </div><!-- unshift-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.2.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>


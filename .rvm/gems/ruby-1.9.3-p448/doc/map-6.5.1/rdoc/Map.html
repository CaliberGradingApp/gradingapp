<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Map - map-6.5.1 Documentation</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/map.rb
    <li>lib/map/integrations/active_record.rb
    <li>lib/map/params.rb
    <li>lib/map/struct.rb
    <li>lib/map/options.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Hash
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-_explode">::_explode</a>
    
    <li><a href="#method-c-add">::add</a>
    
    <li><a href="#method-c-add_conversion_method-21">::add_conversion_method!</a>
    
    <li><a href="#method-c-allocate">::allocate</a>
    
    <li><a href="#method-c-alphanumeric_key_for">::alphanumeric_key_for</a>
    
    <li><a href="#method-c-args_for_arity">::args_for_arity</a>
    
    <li><a href="#method-c-bcall">::bcall</a>
    
    <li><a href="#method-c-blank-3F">::blank?</a>
    
    <li><a href="#method-c-breadth_first_each">::breadth_first_each</a>
    
    <li><a href="#method-c-call">::call</a>
    
    <li><a href="#method-c-coerce">::coerce</a>
    
    <li><a href="#method-c-collection_has-3F">::collection_has?</a>
    
    <li><a href="#method-c-collection_key">::collection_key</a>
    
    <li><a href="#method-c-collection_set">::collection_set</a>
    
    <li><a href="#method-c-combine">::combine</a>
    
    <li><a href="#method-c-conversion_methods">::conversion_methods</a>
    
    <li><a href="#method-c-convert_key">::convert_key</a>
    
    <li><a href="#method-c-convert_value">::convert_value</a>
    
    <li><a href="#method-c-define_conversion_method-21">::define_conversion_method!</a>
    
    <li><a href="#method-c-demongoize">::demongoize</a>
    
    <li><a href="#method-c-depth_first_each">::depth_first_each</a>
    
    <li><a href="#method-c-depth_first_keys">::depth_first_keys</a>
    
    <li><a href="#method-c-depth_first_values">::depth_first_values</a>
    
    <li><a href="#method-c-each_pair">::each_pair</a>
    
    <li><a href="#method-c-evolve">::evolve</a>
    
    <li><a href="#method-c-explode">::explode</a>
    
    <li><a href="#method-c-for">::for</a>
    
    <li><a href="#method-c-from_hash">::from_hash</a>
    
    <li><a href="#method-c-intersection">::intersection</a>
    
    <li><a href="#method-c-key_for">::key_for</a>
    
    <li><a href="#method-c-keys_for">::keys_for</a>
    
    <li><a href="#method-c-libdir">::libdir</a>
    
    <li><a href="#method-c-load">::load</a>
    
    <li><a href="#method-c-map_for">::map_for</a>
    
    <li><a href="#method-c-match">::match</a>
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-c-options_for">::options_for</a>
    
    <li><a href="#method-c-options_for-21">::options_for!</a>
    
    <li><a href="#method-c-pairs_for">::pairs_for</a>
    
    <li><a href="#method-c-struct">::struct</a>
    
    <li><a href="#method-c-tap">::tap</a>
    
    <li><a href="#method-c-update_options_for-21">::update_options_for!</a>
    
    <li><a href="#method-c-version">::version</a>
    
    <li><a href="#method-i-3C-3D-3E">#&lt;=&gt;</a>
    
    <li><a href="#method-i-3D-3D">#==</a>
    
    <li><a href="#method-i-3D-7E">#=~</a>
    
    <li><a href="#method-i-5B-5D">#[]</a>
    
    <li><a href="#method-i-5B-5D-3D">#[]=</a>
    
    <li><a href="#method-i-add">#add</a>
    
    <li><a href="#method-i-alphanumeric_key_for">#alphanumeric_key_for</a>
    
    <li><a href="#method-i-apply">#apply</a>
    
    <li><a href="#method-i-blank-3F">#blank?</a>
    
    <li><a href="#method-i-breadth_first_each">#breadth_first_each</a>
    
    <li><a href="#method-i-clear">#clear</a>
    
    <li><a href="#method-i-clone">#clone</a>
    
    <li><a href="#method-i-collection_has-3F">#collection_has?</a>
    
    <li><a href="#method-i-collection_key">#collection_key</a>
    
    <li><a href="#method-i-collection_set">#collection_set</a>
    
    <li><a href="#method-i-combine">#combine</a>
    
    <li><a href="#method-i-combine-21">#combine!</a>
    
    <li><a href="#method-i-contains">#contains</a>
    
    <li><a href="#method-i-conversion_methods">#conversion_methods</a>
    
    <li><a href="#method-i-convert">#convert</a>
    
    <li><a href="#method-i-convert_key">#convert_key</a>
    
    <li><a href="#method-i-convert_value">#convert_value</a>
    
    <li><a href="#method-i-copy">#copy</a>
    
    <li><a href="#method-i-default">#default</a>
    
    <li><a href="#method-i-default-3D">#default=</a>
    
    <li><a href="#method-i-delete">#delete</a>
    
    <li><a href="#method-i-delete_if">#delete_if</a>
    
    <li><a href="#method-i-depth_first_each">#depth_first_each</a>
    
    <li><a href="#method-i-depth_first_keys">#depth_first_keys</a>
    
    <li><a href="#method-i-depth_first_values">#depth_first_values</a>
    
    <li><a href="#method-i-deserialize">#deserialize</a>
    
    <li><a href="#method-i-dup">#dup</a>
    
    <li><a href="#method-i-each">#each</a>
    
    <li><a href="#method-i-each_key">#each_key</a>
    
    <li><a href="#method-i-each_value">#each_value</a>
    
    <li><a href="#method-i-each_with_index">#each_with_index</a>
    
    <li><a href="#method-i-extractable_options-3F">#extractable_options?</a>
    
    <li><a href="#method-i-fetch">#fetch</a>
    
    <li><a href="#method-i-first">#first</a>
    
    <li><a href="#method-i-forcing">#forcing</a>
    
    <li><a href="#method-i-forcing-3F">#forcing?</a>
    
    <li><a href="#method-i-get">#get</a>
    
    <li><a href="#method-i-has-3F">#has?</a>
    
    <li><a href="#method-i-id">#id</a>
    
    <li><a href="#method-i-initialize_from_array">#initialize_from_array</a>
    
    <li><a href="#method-i-initialize_from_hash">#initialize_from_hash</a>
    
    <li><a href="#method-i-inspect">#inspect</a>
    
    <li><a href="#method-i-invert">#invert</a>
    
    <li><a href="#method-i-keep_if">#keep_if</a>
    
    <li><a href="#method-i-key-3F">#key?</a>
    
    <li><a href="#method-i-key_for">#key_for</a>
    
    <li><a href="#method-i-keys">#keys</a>
    
    <li><a href="#method-i-klass">#klass</a>
    
    <li><a href="#method-i-last">#last</a>
    
    <li><a href="#method-i-leaf_for">#leaf_for</a>
    
    <li><a href="#method-i-map_for">#map_for</a>
    
    <li><a href="#method-i-merge">#merge</a>
    
    <li><a href="#method-i-method_missing">#method_missing</a>
    
    <li><a href="#method-i-mongoize">#mongoize</a>
    
    <li><a href="#method-i-name_for">#name_for</a>
    
    <li><a href="#method-i-param_for">#param_for</a>
    
    <li><a href="#method-i-pop">#pop</a>
    
    <li><a href="#method-i-push">#push</a>
    
    <li><a href="#method-i-reject">#reject</a>
    
    <li><a href="#method-i-reject-21">#reject!</a>
    
    <li><a href="#method-i-reorder">#reorder</a>
    
    <li><a href="#method-i-reorder-21">#reorder!</a>
    
    <li><a href="#method-i-replace">#replace</a>
    
    <li><a href="#method-i-respond_to-3F">#respond_to?</a>
    
    <li><a href="#method-i-reverse_merge">#reverse_merge</a>
    
    <li><a href="#method-i-reverse_merge-21">#reverse_merge!</a>
    
    <li><a href="#method-i-rm">#rm</a>
    
    <li><a href="#method-i-select">#select</a>
    
    <li><a href="#method-i-serialize">#serialize</a>
    
    <li><a href="#method-i-set">#set</a>
    
    <li><a href="#method-i-shift">#shift</a>
    
    <li><a href="#method-i-stringify_keys">#stringify_keys</a>
    
    <li><a href="#method-i-stringify_keys-21">#stringify_keys!</a>
    
    <li><a href="#method-i-struct">#struct</a>
    
    <li><a href="#method-i-symbolize_keys">#symbolize_keys</a>
    
    <li><a href="#method-i-symbolize_keys-21">#symbolize_keys!</a>
    
    <li><a href="#method-i-to_array">#to_array</a>
    
    <li><a href="#method-i-to_hash">#to_hash</a>
    
    <li><a href="#method-i-to_list">#to_list</a>
    
    <li><a href="#method-i-to_options">#to_options</a>
    
    <li><a href="#method-i-to_options-21">#to_options!</a>
    
    <li><a href="#method-i-to_params">#to_params</a>
    
    <li><a href="#method-i-to_s">#to_s</a>
    
    <li><a href="#method-i-to_yaml">#to_yaml</a>
    
    <li><a href="#method-i-unshift">#unshift</a>
    
    <li><a href="#method-i-update">#update</a>
    
    <li><a href="#method-i-values">#values</a>
    
    <li><a href="#method-i-values_at">#values_at</a>
    
    <li><a href="#method-i-with_indifferent_access">#with_indifferent_access</a>
    
    <li><a href="#method-i-with_indifferent_access-21">#with_indifferent_access!</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Map.html">Map</a>
  
    <li><a href="./Map/Arguments.html">Map::Arguments</a>
  
    <li><a href="./Map/Integrations.html">Map::Integrations</a>
  
    <li><a href="./Map/Integrations/ActiveRecord.html">Map::Integrations::ActiveRecord</a>
  
    <li><a href="./Map/Integrations/ActiveRecord/ClassMethods.html">Map::Integrations::ActiveRecord::ClassMethods</a>
  
    <li><a href="./Map/Options.html">Map::Options</a>
  
    <li><a href="./Map/Param.html">Map::Param</a>
  
    <li><a href="./Map/Struct.html">Map::Struct</a>
  
    <li><a href="./Kernel.html">Kernel</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Map</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="Dup">Dup
        
        <dd class="description">
        
      
        <dt id="Load">Load
        
        <dd class="description">
        
      
        <dt id="Version">Version
        
        <dd class="description">
        
      
      </dl>
    </section>
    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-_explode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_explode</span><span
            class="method-args">(key, value, accum = {:branches => [], :leaves => []})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="_explode-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 890</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">_explode</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">accum</span> = {<span class="ruby-value">:branches</span> =<span class="ruby-operator">&gt;</span> [], <span class="ruby-value">:leaves</span> =<span class="ruby-operator">&gt;</span> []})
  <span class="ruby-identifier">key</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">flatten</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
      <span class="ruby-identifier">accum</span>[<span class="ruby-value">:branches</span>].<span class="ruby-identifier">push</span>([<span class="ruby-identifier">key</span>, <span class="ruby-constant">Array</span>])

      <span class="ruby-identifier">value</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span>, <span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
        <span class="ruby-constant">Map</span>.<span class="ruby-identifier">_explode</span>(<span class="ruby-identifier">key</span> <span class="ruby-operator">+</span> [<span class="ruby-identifier">k</span>], <span class="ruby-identifier">v</span>, <span class="ruby-identifier">accum</span>)
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
      <span class="ruby-identifier">accum</span>[<span class="ruby-value">:branches</span>].<span class="ruby-identifier">push</span>([<span class="ruby-identifier">key</span>, <span class="ruby-constant">Map</span>])

      <span class="ruby-identifier">value</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
        <span class="ruby-constant">Map</span>.<span class="ruby-identifier">_explode</span>(<span class="ruby-identifier">key</span> <span class="ruby-operator">+</span> [<span class="ruby-identifier">k</span>], <span class="ruby-identifier">v</span>, <span class="ruby-identifier">accum</span>)
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">accum</span>[<span class="ruby-value">:leaves</span>].<span class="ruby-identifier">push</span>([<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>])
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">accum</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- _explode-source -->
          
        </div>

        

        
      </div><!-- _explode-method -->

    
      <div id="method-c-add" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="add-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 915</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">add</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten!</span>
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">compact!</span>

  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>).<span class="ruby-identifier">tap</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">map</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">map</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">arg</span>)}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- add-source -->
          
        </div>

        

        
      </div><!-- add-method -->

    
      <div id="method-c-add_conversion_method-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_conversion_method!</span><span
            class="method-args">(method)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="add_conversion_method-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 94</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">add_conversion_method!</span>(<span class="ruby-identifier">method</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">define_conversion_method!</span>(<span class="ruby-identifier">method</span>)
        <span class="ruby-identifier">method</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArguementError</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">module_eval</span>(<span class="ruby-string">&quot;          unless conversion_methods.include?(#{ method.inspect })
            conversion_methods.unshift(#{ method.inspect })
          end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span>)
        <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span></pre>
          </div><!-- add_conversion_method-21-source -->
          
        </div>

        

        
      </div><!-- add_conversion_method-21-method -->

    
      <div id="method-c-allocate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">allocate</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="allocate-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 29</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">allocate</span>
  <span class="ruby-keyword">super</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@keys</span> = []
    <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- allocate-source -->
          
        </div>

        

        
      </div><!-- allocate-method -->

    
      <div id="method-c-alphanumeric_key_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">alphanumeric_key_for</span><span
            class="method-args">(key)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="alphanumeric_key_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1020</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">alphanumeric_key_for</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Numeric</span>)

  <span class="ruby-identifier">digity</span>, <span class="ruby-identifier">stringy</span>, <span class="ruby-identifier">digits</span> = <span class="ruby-regexp">/^(~)?(\d+)$/</span><span class="ruby-identifier">omx</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">to_a</span>

  <span class="ruby-identifier">digity</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">stringy</span> <span class="ruby-operator">?</span> <span class="ruby-constant">String</span>(<span class="ruby-identifier">digits</span>) <span class="ruby-operator">:</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">digits</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">key</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- alphanumeric_key_for-source -->
          
        </div>

        

        
      </div><!-- alphanumeric_key_for-method -->

    
      <div id="method-c-args_for_arity" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">args_for_arity</span><span
            class="method-args">(args, arity)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="args_for_arity-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 178</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">args_for_arity</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">arity</span>)
  <span class="ruby-identifier">arity</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">arity</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:arity</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">arity</span>.<span class="ruby-identifier">arity</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">arity</span>)
  <span class="ruby-identifier">arity</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">arity</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- args_for_arity-source -->
          
        </div>

        

        
      </div><!-- args_for_arity-method -->

    
      <div id="method-c-bcall" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bcall</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="bcall-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 188</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bcall</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">args</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">args_for_arity</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">block</span>.<span class="ruby-identifier">arity</span>)
  <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(*<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- bcall-source -->
          
        </div>

        

        
      </div><!-- bcall-method -->

    
      <div id="method-c-blank-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">blank?</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="blank-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 727</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">blank?</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:blank?</span>)

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
      <span class="ruby-identifier">value</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Numeric</span>
      <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">value</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:empty?</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">:</span> <span class="ruby-operator">!</span><span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- blank-3F-source -->
          
        </div>

        

        
      </div><!-- blank-3F-method -->

    
      <div id="method-c-breadth_first_each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">breadth_first_each</span><span
            class="method-args">(enumerable, accum = [], &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="breadth_first_each-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1093</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">breadth_first_each</span>(<span class="ruby-identifier">enumerable</span>, <span class="ruby-identifier">accum</span> = [], &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">levels</span> = []

  <span class="ruby-identifier">keys</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_keys</span>(<span class="ruby-identifier">enumerable</span>)

  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">key</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">k</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">i</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
      <span class="ruby-identifier">level</span> = <span class="ruby-identifier">k</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">levels</span>[<span class="ruby-identifier">level</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
      <span class="ruby-identifier">last</span> = <span class="ruby-identifier">levels</span>[<span class="ruby-identifier">level</span>].<span class="ruby-identifier">last</span>
      <span class="ruby-identifier">levels</span>[<span class="ruby-identifier">level</span>].<span class="ruby-identifier">push</span>(<span class="ruby-identifier">k</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">k</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">levels</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">level</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">level</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">val</span> = <span class="ruby-identifier">enumerable</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">key</span>)
      <span class="ruby-identifier">block</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">push</span>([<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">block</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">enumerable</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">accum</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- breadth_first_each-source -->
          
        </div>

        

        
      </div><!-- breadth_first_each-method -->

    
      <div id="method-c-call" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">call</span><span
            class="method-args">(object, method, *args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="call-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 183</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">object</span>, <span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">args</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">args_for_arity</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">object</span>.<span class="ruby-identifier">method</span>(<span class="ruby-identifier">method</span>).<span class="ruby-identifier">arity</span>)
  <span class="ruby-identifier">object</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- call-source -->
          
        </div>

        

        
      </div><!-- call-method -->

    
      <div id="method-c-coerce" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">coerce</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="coerce-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">coerce</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">other</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Map</span>
      <span class="ruby-identifier">other</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">allocate</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">other</span>.<span class="ruby-identifier">to_hash</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- coerce-source -->
          
        </div>

        

        
      </div><!-- coerce-method -->

    
      <div id="method-c-collection_has-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collection_has?</span><span
            class="method-args">(collection, key, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="collection_has-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 769</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">key</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">has_key</span> =
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">collection</span>
      <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
        <span class="ruby-identifier">key</span> = (<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">key</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-value">-1</span>)
        (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">collection</span>.<span class="ruby-identifier">size</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">key</span>)

      <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
        <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">key</span>)

      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">raise</span>(<span class="ruby-constant">IndexError</span>, <span class="ruby-node">&quot;(#{ collection.inspect })[#{ key.inspect }]&quot;</span>)
    <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">key</span>) <span class="ruby-keyword">if</span>(<span class="ruby-identifier">has_key</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">block</span>)

  <span class="ruby-identifier">has_key</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- collection_has-3F-source -->
          
        </div>

        

        
      </div><!-- collection_has-3F-method -->

    
      <div id="method-c-collection_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collection_key</span><span
            class="method-args">(collection, key, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="collection_key-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 747</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_key</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">key</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">collection</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-identifier">key</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">key</span>)
      <span class="ruby-keyword">rescue</span>
        <span class="ruby-identifier">raise</span>(<span class="ruby-constant">IndexError</span>, <span class="ruby-node">&quot;(#{ collection.inspect })[#{ key.inspect }]&quot;</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">collection</span>[<span class="ruby-identifier">key</span>]

    <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
      <span class="ruby-identifier">collection</span>[<span class="ruby-identifier">key</span>]

    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span>(<span class="ruby-constant">IndexError</span>, <span class="ruby-node">&quot;(#{ collection.inspect })[#{ key.inspect }]&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- collection_key-source -->
          
        </div>

        

        
      </div><!-- collection_key-method -->

    
      <div id="method-c-collection_set" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collection_set</span><span
            class="method-args">(collection, key, value, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="collection_set-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 792</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_set</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">set_key</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">collection</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-identifier">key</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">key</span>)
      <span class="ruby-keyword">rescue</span>
        <span class="ruby-identifier">raise</span>(<span class="ruby-constant">IndexError</span>, <span class="ruby-node">&quot;(#{ collection.inspect })[#{ key.inspect }]=#{ value.inspect }&quot;</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">set_key</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">collection</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>

    <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
      <span class="ruby-identifier">set_key</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">collection</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>

    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span>(<span class="ruby-constant">IndexError</span>, <span class="ruby-node">&quot;(#{ collection.inspect })[#{ key.inspect }]=#{ value.inspect }&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">key</span>) <span class="ruby-keyword">if</span>(<span class="ruby-identifier">set_key</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">block</span>)

  [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- collection_set-source -->
          
        </div>

        

        
      </div><!-- collection_set-method -->

    
      <div id="method-c-combine" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">combine</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="combine-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 924</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">combine</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">add</span>(*<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- combine-source -->
          
        </div>

        

        
      </div><!-- combine-method -->

    
      <div id="method-c-conversion_methods" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">conversion_methods</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="conversion_methods-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">conversion_methods</span>
  <span class="ruby-ivar">@conversion_methods</span> <span class="ruby-operator">||=</span> (
    <span class="ruby-identifier">map_like</span> = <span class="ruby-identifier">ancestors</span>.<span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">ancestor</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ancestor</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-constant">Map</span>}
    <span class="ruby-identifier">type_names</span> = <span class="ruby-identifier">map_like</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ancestor</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">name</span> = <span class="ruby-identifier">ancestor</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">name</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/::/</span>, <span class="ruby-string">'_'</span>)
    <span class="ruby-keyword">end</span>.<span class="ruby-identifier">compact</span>
    <span class="ruby-identifier">list</span> = <span class="ruby-identifier">type_names</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">type_name</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;to_#{ type_name }&quot;</span>}
    <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span> <span class="ruby-identifier">define_conversion_method!</span>(<span class="ruby-identifier">method</span>)}
    <span class="ruby-identifier">list</span>
  )
<span class="ruby-keyword">end</span></pre>
          </div><!-- conversion_methods-source -->
          
        </div>

        

        
      </div><!-- conversion_methods-method -->

    
      <div id="method-c-convert_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_key</span><span
            class="method-args">(key)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="convert_key-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 253</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">key</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Symbol</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">key</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_key-source -->
          
        </div>

        

        
      </div><!-- convert_key-method -->

    
      <div id="method-c-convert_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_value</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="convert_value-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 265</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">convert_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">conversion_methods</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
    <span class="ruby-comment">#return convert_value(value.send(method)) if value.respond_to?(method)</span>
    <span class="ruby-identifier">hashlike</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">hashlike</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
      <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>)
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
      <span class="ruby-identifier">coerce</span>(<span class="ruby-identifier">value</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
      <span class="ruby-identifier">value</span>.<span class="ruby-identifier">map!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">convert_value</span>(<span class="ruby-identifier">v</span>)}
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_value-source -->
          
        </div>

        

        
      </div><!-- convert_value-method -->

    
      <div id="method-c-define_conversion_method-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">define_conversion_method!</span><span
            class="method-args">(method)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="define_conversion_method-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 79</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">define_conversion_method!</span>(<span class="ruby-identifier">method</span>)
      <span class="ruby-identifier">method</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArguementError</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">module_eval</span>(<span class="ruby-string">&quot;        unless public_method_defined?(#{ method.inspect })
          def #{ method }
            self
          end
          true
        else
          false
        end
&quot;</span>, <span class="ruby-keyword">__FILE__</span>, <span class="ruby-keyword">__LINE__</span>)
    <span class="ruby-keyword">end</span></pre>
          </div><!-- define_conversion_method-21-source -->
          
        </div>

        

        
      </div><!-- define_conversion_method-21-method -->

    
      <div id="method-c-demongoize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">demongoize</span><span
            class="method-args">(object)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="demongoize-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1162</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">demongoize</span>(<span class="ruby-identifier">object</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">object</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- demongoize-source -->
          
        </div>

        

        
      </div><!-- demongoize-method -->

    
      <div id="method-c-depth_first_each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depth_first_each</span><span
            class="method-args">(enumerable, path = [], accum = [], &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>TODO - technically this returns only leaves so the name isnt
<strong>quite</strong> right.  re-factor for 3.0</p>
          

          
          <div class="method-source-code" id="depth_first_each-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1042</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_each</span>(<span class="ruby-identifier">enumerable</span>, <span class="ruby-identifier">path</span> = [], <span class="ruby-identifier">accum</span> = [], &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">pairs_for</span>(<span class="ruby-identifier">enumerable</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">path</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-keyword">if</span>((<span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)) <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">empty?</span>)
      <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_each</span>(<span class="ruby-identifier">val</span>, <span class="ruby-identifier">path</span>, <span class="ruby-identifier">accum</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">accum</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span>, <span class="ruby-identifier">val</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">path</span>.<span class="ruby-identifier">pop</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">keys</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">keys</span>, <span class="ruby-identifier">val</span>)}
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">accum</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- depth_first_each-source -->
          
        </div>

        

        
      </div><!-- depth_first_each-method -->

    
      <div id="method-c-depth_first_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depth_first_keys</span><span
            class="method-args">(enumerable, path = [], accum = [], &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="depth_first_keys-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1059</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_keys</span>(<span class="ruby-identifier">enumerable</span>, <span class="ruby-identifier">path</span> = [], <span class="ruby-identifier">accum</span> = [], &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">accum</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_each</span>(<span class="ruby-identifier">enumerable</span>, <span class="ruby-identifier">path</span> = [], <span class="ruby-identifier">accum</span> = [], &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">map!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">kv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">kv</span>.<span class="ruby-identifier">first</span>}
  <span class="ruby-identifier">accum</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- depth_first_keys-source -->
          
        </div>

        

        
      </div><!-- depth_first_keys-method -->

    
      <div id="method-c-depth_first_values" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depth_first_values</span><span
            class="method-args">(enumerable, path = [], accum = [], &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="depth_first_values-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1065</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_values</span>(<span class="ruby-identifier">enumerable</span>, <span class="ruby-identifier">path</span> = [], <span class="ruby-identifier">accum</span> = [], &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">accum</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_each</span>(<span class="ruby-identifier">enumerable</span>, <span class="ruby-identifier">path</span> = [], <span class="ruby-identifier">accum</span> = [], &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">accum</span>.<span class="ruby-identifier">map!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">kv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">kv</span>.<span class="ruby-identifier">last</span>}
  <span class="ruby-identifier">accum</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- depth_first_values-source -->
          
        </div>

        

        
      </div><!-- depth_first_values-method -->

    
      <div id="method-c-each_pair" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_pair</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>iterate over arguments in pairs smartly.</p>
          

          
          <div class="method-source-code" id="each_pair-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 111</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_pair</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">size</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">first</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">result</span> = []
    <span class="ruby-identifier">block</span> = <span class="ruby-identifier">lambda</span>{<span class="ruby-operator">|</span>*<span class="ruby-identifier">kv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">kv</span>)}
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">args</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">args</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">conversion_methods</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">first</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>)
        <span class="ruby-identifier">first</span> = <span class="ruby-identifier">first</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>)
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">first</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:each_pair</span>)
      <span class="ruby-identifier">first</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">args</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">first</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:each_slice</span>)
      <span class="ruby-identifier">first</span>.<span class="ruby-identifier">each_slice</span>(<span class="ruby-value">2</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">args</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">'odd number of arguments for Map'</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">array_of_pairs</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-keyword">and</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>}

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">array_of_pairs</span>
    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span> = <span class="ruby-identifier">pair</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">1</span>]
      <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-value">0</span>.<span class="ruby-identifier">step</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-value">2</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-identifier">args</span>[<span class="ruby-identifier">a</span>]
      <span class="ruby-identifier">val</span> = <span class="ruby-identifier">args</span>[<span class="ruby-identifier">a</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>]
      <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">args</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_pair-source -->
          
        </div>

        

        
      </div><!-- each_pair-method -->

    
      <div id="method-c-evolve" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evolve</span><span
            class="method-args">(object)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="evolve-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1166</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">evolve</span>(<span class="ruby-identifier">object</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">object</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- evolve-source -->
          
        </div>

        

        
      </div><!-- evolve-method -->

    
      <div id="method-c-explode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">explode</span><span
            class="method-args">(hash)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="explode-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 872</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">explode</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">accum</span> = {<span class="ruby-value">:branches</span> =<span class="ruby-operator">&gt;</span> [], <span class="ruby-value">:leaves</span> =<span class="ruby-operator">&gt;</span> []}

  <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">Map</span>.<span class="ruby-identifier">_explode</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">accum</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">branches</span> = <span class="ruby-identifier">accum</span>[<span class="ruby-value">:branches</span>]
  <span class="ruby-identifier">leaves</span> = <span class="ruby-identifier">accum</span>[<span class="ruby-value">:leaves</span>]

  <span class="ruby-identifier">sort_by_key_size</span> = <span class="ruby-identifier">proc</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">b</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">size</span>}

  <span class="ruby-identifier">branches</span>.<span class="ruby-identifier">sort!</span>(&amp;<span class="ruby-identifier">sort_by_key_size</span>)
  <span class="ruby-identifier">leaves</span>.<span class="ruby-identifier">sort!</span>(&amp;<span class="ruby-identifier">sort_by_key_size</span>)

  <span class="ruby-identifier">accum</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- explode-source -->
          
        </div>

        

        
      </div><!-- explode-method -->

    
      <div id="method-c-for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">for</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 43</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">for</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- for-source -->
          
        </div>

        

        
      </div><!-- for-method -->

    
      <div id="method-c-from_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">from_hash</span><span
            class="method-args">(hash, order = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>support for building ordered hasshes from a maps own image</p>
          

          
          <div class="method-source-code" id="from_hash-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 537</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">order</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">map</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">map</span>.<span class="ruby-identifier">reorder!</span>(<span class="ruby-identifier">order</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">order</span>
  <span class="ruby-identifier">map</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- from_hash-source -->
          
        </div>

        

        
      </div><!-- from_hash-method -->

    
      <div id="method-c-intersection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">intersection</span><span
            class="method-args">(a, b)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="intersection-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 168</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">intersection</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>, <span class="ruby-identifier">i</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">a</span>), <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">b</span>), <span class="ruby-constant">Map</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">a</span>.<span class="ruby-identifier">depth_first_each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">b</span>.<span class="ruby-identifier">has?</span>(<span class="ruby-identifier">key</span>)}
  <span class="ruby-identifier">i</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- intersection-source -->
          
        </div>

        

        
      </div><!-- intersection-method -->

    
      <div id="method-c-key_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">key_for</span><span
            class="method-args">(*keys)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="key_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1032</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">key_for</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">flatten</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- key_for-source -->
          
        </div>

        

        
      </div><!-- key_for-method -->

    
      <div id="method-c-keys_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">keys_for</span><span
            class="method-args">(enumerable)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="keys_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1118</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">keys_for</span>(<span class="ruby-identifier">enumerable</span>)
  <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">enumerable</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:keys</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">enumerable</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">:</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">enumerable</span>.<span class="ruby-identifier">size</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>}
  <span class="ruby-identifier">keys</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- keys_for-source -->
          
        </div>

        

        
      </div><!-- keys_for-method -->

    
      <div id="method-c-libdir" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">libdir</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="libdir-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 11</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">libdir</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@libdir</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-keyword">__FILE__</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\.rb$/</span>,<span class="ruby-string">''</span>)
  <span class="ruby-identifier">libdir</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@libdir</span> <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@libdir</span>, *<span class="ruby-identifier">args</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_s</span>})
<span class="ruby-keyword">ensure</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">libdir</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">first</span><span class="ruby-operator">==</span><span class="ruby-identifier">libdir</span>
      <span class="ruby-identifier">module_eval</span>(&amp;<span class="ruby-identifier">block</span>)
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">shift</span>() <span class="ruby-keyword">if</span> <span class="ruby-identifier">$LOAD_PATH</span>.<span class="ruby-identifier">first</span><span class="ruby-operator">==</span><span class="ruby-identifier">libdir</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- libdir-source -->
          
        </div>

        

        
      </div><!-- libdir-method -->

    
      <div id="method-c-load" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="load-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 25</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">libdir</span>{ <span class="ruby-constant">Load</span>.<span class="ruby-identifier">call</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
          </div><!-- load-source -->
          
        </div>

        

        
      </div><!-- load-method -->

    
      <div id="method-c-map_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">map_for</span><span
            class="method-args">(hash)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="map_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 244</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">map_for</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">map</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">coerce</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">map</span>.<span class="ruby-identifier">default</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">default</span>
  <span class="ruby-identifier">map</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- map_for-source -->
          
        </div>

        

        
      </div><!-- map_for-method -->

    
      <div id="method-c-match" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">match</span><span
            class="method-args">(haystack, needle)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="match-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 174</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">haystack</span>, <span class="ruby-identifier">needle</span>)
  <span class="ruby-identifier">intersection</span>(<span class="ruby-identifier">haystack</span>, <span class="ruby-identifier">needle</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">needle</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- match-source -->
          
        </div>

        

        
      </div><!-- match-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 200</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword">when</span> <span class="ruby-value">0</span>
      <span class="ruby-keyword">super</span>(&amp;<span class="ruby-identifier">block</span>)

    <span class="ruby-keyword">when</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">first</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>
      <span class="ruby-keyword">case</span> <span class="ruby-identifier">first</span>
        <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>, <span class="ruby-keyword">false</span>
          <span class="ruby-keyword">nil</span>
        <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
          <span class="ruby-identifier">initialize_from_hash</span>(<span class="ruby-identifier">first</span>)
        <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
          <span class="ruby-identifier">initialize_from_array</span>(<span class="ruby-identifier">first</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">first</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
            <span class="ruby-identifier">initialize_from_hash</span>(<span class="ruby-identifier">first</span>.<span class="ruby-identifier">to_hash</span>)
          <span class="ruby-keyword">else</span>
            <span class="ruby-identifier">initialize_from_hash</span>(<span class="ruby-identifier">first</span>)
          <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">initialize_from_array</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">allocate</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">initialize</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
    <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-options_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">options_for</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="options_for-source">
            <pre><span class="ruby-comment"># File lib/map/options.rb, line 160</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">options_for</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span>.<span class="ruby-identifier">for</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- options_for-source -->
          
        </div>

        

        
      </div><!-- options_for-method -->

    
      <div id="method-c-options_for-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">options_for!</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="options_for-21-source">
            <pre><span class="ruby-comment"># File lib/map/options.rb, line 164</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">options_for!</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span>.<span class="ruby-identifier">for</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>).<span class="ruby-identifier">pop</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- options_for-21-source -->
          
        </div>

        

        
      </div><!-- options_for-21-method -->

    
      <div id="method-c-pairs_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pairs_for</span><span
            class="method-args">(enumerable, *args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="pairs_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1071</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">pairs_for</span>(<span class="ruby-identifier">enumerable</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">pairs</span>, <span class="ruby-identifier">block</span> = [], <span class="ruby-identifier">lambda</span>{<span class="ruby-operator">|</span>*<span class="ruby-identifier">pair</span><span class="ruby-operator">|</span> <span class="ruby-identifier">pairs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">pair</span>)}
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">pairs</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">result</span> =
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">enumerable</span>
      <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
        <span class="ruby-identifier">enumerable</span>.<span class="ruby-identifier">each_pair</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
      <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
        <span class="ruby-identifier">enumerable</span>.<span class="ruby-identifier">each_with_index</span>(*<span class="ruby-identifier">args</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span>, <span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">enumerable</span>.<span class="ruby-identifier">each_pair</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
    <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">pairs</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">pairs</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pairs_for-source -->
          
        </div>

        

        
      </div><!-- pairs_for-method -->

    
      <div id="method-c-struct" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">struct</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="struct-source">
            <pre><span class="ruby-comment"># File lib/map/struct.rb, line 49</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">struct</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>).<span class="ruby-identifier">struct</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- struct-source -->
          
        </div>

        

        
      </div><!-- struct-method -->

    
      <div id="method-c-tap" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">tap</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="tap-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">tap</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>).<span class="ruby-identifier">tap</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">map</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">map</span>.<span class="ruby-identifier">tap</span>(&amp;<span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- tap-source -->
          
        </div>

        

        
      </div><!-- tap-method -->

    
      <div id="method-c-update_options_for-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update_options_for!</span><span
            class="method-args">(args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="update_options_for-21-source">
            <pre><span class="ruby-comment"># File lib/map/options.rb, line 168</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">update_options_for!</span>(<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">options_for</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- update_options_for-21-source -->
          
        </div>

        

        
      </div><!-- update_options_for-21-method -->

    
      <div id="method-c-version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">version</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="version-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 7</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">version</span>
  <span class="ruby-constant">Map</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- version-source -->
          
        </div>

        

        
      </div><!-- version-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-3C-3D-3E" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&lt;=&gt;</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="3C-3D-3E-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 511</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">&lt;=&gt;</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-identifier">cmp</span> = <span class="ruby-identifier">keys</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">coerce</span>(<span class="ruby-identifier">other</span>).<span class="ruby-identifier">keys</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">cmp</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cmp</span>.<span class="ruby-identifier">zero?</span>
  <span class="ruby-identifier">values</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">coerce</span>(<span class="ruby-identifier">other</span>).<span class="ruby-identifier">values</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- 3C-3D-3E-source -->
          
        </div>

        

        
      </div><!-- 3C-3D-3E-method -->

    
      <div id="method-i-3D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">==</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>equality / sorting / matching support</p>
          

          
          <div class="method-source-code" id="3D-3D-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 497</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">other</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Map</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">keys</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">keys</span>
      <span class="ruby-keyword">super</span>(<span class="ruby-identifier">other</span>)

    <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
      <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">other</span>, <span class="ruby-keyword">self</span>)

    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- 3D-3D-source -->
          
        </div>

        

        
      </div><!-- 3D-3D-method -->

    
      <div id="method-i-3D-7E" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">=~</span><span
            class="method-args">(hash)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="3D-7E-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 517</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">=~</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">to_hash</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">coerce</span>(<span class="ruby-identifier">hash</span>).<span class="ruby-identifier">to_hash</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- 3D-7E-source -->
          
        </div>

        

        
      </div><!-- 3D-7E-method -->

    
      <div id="method-i-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(key)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 338</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">key</span> = <span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">__get__</span>(<span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- 5B-5D-source -->
          
        </div>

        

        
      </div><!-- 5B-5D-method -->

    
      <div id="method-i-5B-5D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]=</span><span
            class="method-args">(key, val)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="5B-5D-3D-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 331</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
  <span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span> = <span class="ruby-identifier">convert</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">key</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">__set__</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- 5B-5D-3D-source -->
          
        </div>

        

        
      </div><!-- 5B-5D-3D-method -->

    
      <div id="method-i-add" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="add-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 846</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">case</span>
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-keyword">return</span> []
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">hash</span> = {}
      <span class="ruby-identifier">value</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">args</span>).<span class="ruby-identifier">flatten</span>
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">exploded</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">explode</span>(<span class="ruby-identifier">hash</span>)

  <span class="ruby-identifier">exploded</span>[<span class="ruby-value">:branches</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">bkey</span>, <span class="ruby-identifier">btype</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">set</span>(<span class="ruby-identifier">bkey</span>, <span class="ruby-identifier">btype</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">bkey</span>).<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">btype</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">exploded</span>[<span class="ruby-value">:leaves</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">lkey</span>, <span class="ruby-identifier">lvalue</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">set</span>(<span class="ruby-identifier">lkey</span>, <span class="ruby-identifier">lvalue</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- add-source -->
          
        </div>

        

        
      </div><!-- add-method -->

    
      <div id="method-i-alphanumeric_key_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">alphanumeric_key_for</span><span
            class="method-args">(key)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="alphanumeric_key_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1028</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">alphanumeric_key_for</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">alphanumeric_key_for</span>(<span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- alphanumeric_key_for-source -->
          
        </div>

        

        
      </div><!-- alphanumeric_key_for-method -->

    
      <div id="method-i-apply" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">apply</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="apply-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1013</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">apply</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">other</span>).<span class="ruby-identifier">depth_first_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">keys</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">set</span>(<span class="ruby-identifier">keys</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">value</span>) <span class="ruby-keyword">unless</span> <span class="ruby-operator">!</span><span class="ruby-identifier">get</span>(<span class="ruby-identifier">keys</span>).<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- apply-source -->
          
        </div>

        

        
      </div><!-- apply-method -->

    
      <div id="method-i-blank-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">blank?</span><span
            class="method-args">(*keys)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="blank-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 742</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">blank?</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">empty?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-operator">!</span><span class="ruby-identifier">has?</span>(*<span class="ruby-identifier">keys</span>) <span class="ruby-keyword">or</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">blank?</span>(<span class="ruby-identifier">get</span>(*<span class="ruby-identifier">keys</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- blank-3F-source -->
          
        </div>

        

        
      </div><!-- blank-3F-method -->

    
      <div id="method-i-breadth_first_each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">breadth_first_each</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="breadth_first_each-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">breadth_first_each</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">breadth_first_each</span>(<span class="ruby-keyword">self</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- breadth_first_each-source -->
          
        </div>

        

        
      </div><!-- breadth_first_each-method -->

    
      <div id="method-i-clear" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clear</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="clear-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 426</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- clear-source -->
          
        </div>

        

        
      </div><!-- clear-method -->

    
      <div id="method-i-clone" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clone</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="clone-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 313</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clone</span>
  <span class="ruby-identifier">copy</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- clone-source -->
          
        </div>

        

        
      </div><!-- clone-method -->

    
      <div id="method-i-collection_has-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collection_has?</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="collection_has-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 788</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">collection_has?</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- collection_has-3F-source -->
          
        </div>

        

        
      </div><!-- collection_has-3F-method -->

    
      <div id="method-i-collection_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collection_key</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="collection_key-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 765</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">collection_key</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_key</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- collection_key-source -->
          
        </div>

        

        
      </div><!-- collection_key-method -->

    
      <div id="method-i-collection_set" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">collection_set</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="collection_set-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 818</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">collection_set</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_set</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- collection_set-source -->
          
        </div>

        

        
      </div><!-- collection_set-method -->

    
      <div id="method-i-combine" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">combine</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="combine-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 932</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">combine</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">tap</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">map</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">map</span>.<span class="ruby-identifier">combine!</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- combine-source -->
          
        </div>

        

        
      </div><!-- combine-method -->

    
      <div id="method-i-combine-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">combine!</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="combine-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 928</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">combine!</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">add</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- combine-21-source -->
          
        </div>

        

        
      </div><!-- combine-21-method -->

    
      <div id="method-i-contains" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">contains</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="contains-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1139</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">contains</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-identifier">other</span> = <span class="ruby-identifier">other</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">coerce</span>(<span class="ruby-identifier">other</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">other</span>
  <span class="ruby-identifier">breadth_first_each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>}
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- contains-source -->
          
        </div>

        

        
      </div><!-- contains-method -->

    
      <div id="method-i-conversion_methods" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">conversion_methods</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>conversions</p>
          

          
          <div class="method-source-code" id="conversion_methods-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 572</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">conversion_methods</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">conversion_methods</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- conversion_methods-source -->
          
        </div>

        

        
      </div><!-- conversion_methods-method -->

    
      <div id="method-i-convert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert</span><span
            class="method-args">(key, val)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="convert-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 293</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
  [<span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>), <span class="ruby-identifier">convert_value</span>(<span class="ruby-identifier">val</span>)]
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert-source -->
          
        </div>

        

        
      </div><!-- convert-method -->

    
      <div id="method-i-convert_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_key</span><span
            class="method-args">(key)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="convert_key-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 257</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:convert_key</span>)
    <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Map</span>.<span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_key-source -->
          
        </div>

        

        
      </div><!-- convert_key-method -->

    
      <div id="method-i-convert_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_value</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="convert_value-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 284</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:convert_value</span>)
    <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">convert_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Map</span>.<span class="ruby-identifier">convert_value</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- convert_value-source -->
          
        </div>

        

        
      </div><!-- convert_value-method -->

    
      <div id="method-i-copy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">copy</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="copy-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 297</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">copy</span>
  <span class="ruby-identifier">default</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">default</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">default</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">copy</span> = <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-keyword">self</span>)) <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Dup</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-keyword">self</span>).<span class="ruby-identifier">call</span>()
  <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">default</span> = <span class="ruby-identifier">default</span>
  <span class="ruby-identifier">copy</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">default</span> = <span class="ruby-identifier">default</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- copy-source -->
          
        </div>

        

        
      </div><!-- copy-method -->

    
      <div id="method-i-default" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default</span><span
            class="method-args">(key = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="default-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 317</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">default</span>(<span class="ruby-identifier">key</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">include?</span>(<span class="ruby-identifier">key</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- default-source -->
          
        </div>

        

        
      </div><!-- default-method -->

    
      <div id="method-i-default-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default=</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="default-3D-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 321</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">default=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;Map doesn't work so well with a non-nil default value!&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- default-3D-source -->
          
        </div>

        

        
      </div><!-- default-3D-method -->

    
      <div id="method-i-delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete</span><span
            class="method-args">(key)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>mutators</p>
          

          
          <div class="method-source-code" id="delete-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 420</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">key</span> = <span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">super</span>(<span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete-source -->
          
        </div>

        

        
      </div><!-- delete-method -->

    
      <div id="method-i-delete_if" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_if</span><span
            class="method-args">(&block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="delete_if-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 431</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_if</span>(&amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">to_delete</span> = []

  <span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">args</span> = [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>]
    <span class="ruby-identifier">to_delete</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">key</span>) <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-constant">Map</span>.<span class="ruby-identifier">bcall</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">to_delete</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)}

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delete_if-source -->
          
        </div>

        

        
      </div><!-- delete_if-method -->

    
      <div id="method-i-depth_first_each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depth_first_each</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="depth_first_each-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1123</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">depth_first_each</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_each</span>(<span class="ruby-keyword">self</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- depth_first_each-source -->
          
        </div>

        

        
      </div><!-- depth_first_each-method -->

    
      <div id="method-i-depth_first_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depth_first_keys</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="depth_first_keys-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1127</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">depth_first_keys</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_keys</span>(<span class="ruby-keyword">self</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- depth_first_keys-source -->
          
        </div>

        

        
      </div><!-- depth_first_keys-method -->

    
      <div id="method-i-depth_first_values" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">depth_first_values</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="depth_first_values-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">depth_first_values</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">depth_first_values</span>(<span class="ruby-keyword">self</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- depth_first_values-source -->
          
        </div>

        

        
      </div><!-- depth_first_values-method -->

    
      <div id="method-i-deserialize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">deserialize</span><span
            class="method-args">(object)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="deserialize-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1158</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">deserialize</span>(<span class="ruby-identifier">object</span>)
  <span class="ruby-operator">::</span><span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">object</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- deserialize-source -->
          
        </div>

        

        
      </div><!-- deserialize-method -->

    
      <div id="method-i-dup" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dup</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="dup-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 309</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">copy</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- dup-source -->
          
        </div>

        

        
      </div><!-- dup-method -->

    
      <div id="method-i-each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each</span><span
            class="method-args">() { |key, self| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="each-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 412</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">key</span>, <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>])}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each-source -->
          
        </div>

        

        
      </div><!-- each-method -->

    
      <div id="method-i-each_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_key</span><span
            class="method-args">() { |key| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="each_key-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 402</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_key</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">key</span>)}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_key-source -->
          
        </div>

        

        
      </div><!-- each_key-method -->

    
      <div id="method-i-each_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_value</span><span
            class="method-args">() { |self| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="each_value-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 407</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_value</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>]}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_value-source -->
          
        </div>

        

        
      </div><!-- each_value-method -->

    
      <div id="method-i-each_with_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_with_index</span><span
            class="method-args">() { |[key, self, index| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>iterator methods</p>
          

          
          <div class="method-source-code" id="each_with_index-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 397</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_with_index</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each_with_index</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>([<span class="ruby-identifier">key</span>, <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>]], <span class="ruby-identifier">index</span>)}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_with_index-source -->
          
        </div>

        

        
      </div><!-- each_with_index-method -->

    
      <div id="method-i-extractable_options-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">extractable_options?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>for rails extract_options! compat</p>
          

          
          <div class="method-source-code" id="extractable_options-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">extractable_options?</span>
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- extractable_options-3F-source -->
          
        </div>

        

        
      </div><!-- extractable_options-3F-method -->

    
      <div id="method-i-fetch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fetch</span><span
            class="method-args">(key, *args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="fetch-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 343</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">key</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">key</span> = <span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">super</span>(<span class="ruby-identifier">key</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- fetch-source -->
          
        </div>

        

        
      </div><!-- fetch-method -->

    
      <div id="method-i-first" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">first</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="first-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 387</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">first</span>
  [<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>, <span class="ruby-keyword">self</span>[<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- first-source -->
          
        </div>

        

        
      </div><!-- first-method -->

    
      <div id="method-i-forcing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">forcing</span><span
            class="method-args">(forcing=nil, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="forcing-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 992</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">forcing</span>(<span class="ruby-identifier">forcing</span>=<span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@forcing</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">previous</span> = <span class="ruby-ivar">@forcing</span>
      <span class="ruby-ivar">@forcing</span> = <span class="ruby-identifier">forcing</span>
      <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>()
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-ivar">@forcing</span> = <span class="ruby-identifier">previous</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@forcing</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- forcing-source -->
          
        </div>

        

        
      </div><!-- forcing-method -->

    
      <div id="method-i-forcing-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">forcing?</span><span
            class="method-args">(forcing=nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="forcing-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1008</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">forcing?</span>(<span class="ruby-identifier">forcing</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@forcing</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@forcing</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">forcing</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- forcing-3F-source -->
          
        </div>

        

        
      </div><!-- forcing-3F-method -->

    
      <div id="method-i-get" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get</span><span
            class="method-args">(*keys) { || ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>support for compound key indexing and depth first iteration</p>
          

          
          <div class="method-source-code" id="get-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 670</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">key_for</span>(<span class="ruby-identifier">keys</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">block_given?</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">yield</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>[<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">keys</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">keys</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>], <span class="ruby-identifier">keys</span>[<span class="ruby-value">-1</span>]
  <span class="ruby-identifier">collection</span> = <span class="ruby-keyword">self</span>

  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">k</span>)
      <span class="ruby-identifier">collection</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_key</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">k</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">collection</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-string">'[]'</span>)
      <span class="ruby-identifier">leaf</span> = <span class="ruby-identifier">collection</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">leaf</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">key</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-comment">#default_value</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_key</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- get-source -->
          
        </div>

        

        
      </div><!-- get-method -->

    
      <div id="method-i-has-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">has?</span><span
            class="method-args">(*keys)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="has-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 704</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">has?</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">key_for</span>(<span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">collection</span> = <span class="ruby-keyword">self</span>

  <span class="ruby-keyword">return</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">1</span>

  <span class="ruby-identifier">keys</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">keys</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>], <span class="ruby-identifier">keys</span>[<span class="ruby-value">-1</span>]

  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">k</span>)
      <span class="ruby-identifier">collection</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_key</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">k</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">collection</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">return</span> <span class="ruby-identifier">collection</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-string">'[]'</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span>(<span class="ruby-identifier">collection</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>))

  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- has-3F-source -->
          
        </div>

        

        
      </div><!-- has-3F-method -->

    
      <div id="method-i-id" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">id</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="id-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 662</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">id</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>[<span class="ruby-value">:id</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:id</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>[<span class="ruby-value">:_id</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:_id</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoMethodError</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- id-source -->
          
        </div>

        

        
      </div><!-- id-method -->

    
      <div id="method-i-initialize_from_array" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_from_array</span><span
            class="method-args">(array)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="initialize_from_array-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 233</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_from_array</span>(<span class="ruby-identifier">array</span>)
  <span class="ruby-identifier">map</span> = <span class="ruby-keyword">self</span>
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">each_pair</span>(<span class="ruby-identifier">array</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">map</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">val</span>}
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialize_from_array-source -->
          
        </div>

        

        
      </div><!-- initialize_from_array-method -->

    
      <div id="method-i-initialize_from_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_from_hash</span><span
            class="method-args">(hash)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="initialize_from_hash-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 227</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_from_hash</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">map</span> = <span class="ruby-keyword">self</span>
  <span class="ruby-identifier">map</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">map</span>.<span class="ruby-identifier">default</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">default</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialize_from_hash-source -->
          
        </div>

        

        
      </div><!-- initialize_from_hash-method -->

    
      <div id="method-i-inspect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inspect</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="inspect-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 565</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">require</span> <span class="ruby-string">'pp'</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-constant">PP</span>)
  <span class="ruby-constant">PP</span>.<span class="ruby-identifier">pp</span>(<span class="ruby-keyword">self</span>, <span class="ruby-string">''</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- inspect-source -->
          
        </div>

        

        
      </div><!-- inspect-method -->

    
      <div id="method-i-invert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">invert</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="invert-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 543</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">invert</span>
  <span class="ruby-identifier">inverted</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">allocate</span>
  <span class="ruby-identifier">inverted</span>.<span class="ruby-identifier">default</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">default</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">inverted</span>[<span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>]] = <span class="ruby-identifier">key</span> }
  <span class="ruby-identifier">inverted</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- invert-source -->
          
        </div>

        

        
      </div><!-- invert-method -->

    
      <div id="method-i-keep_if" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">keep_if</span><span
            class="method-args">( ) { |key , val| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>See: <a
href="https://github.com/rubinius/rubinius/blob/98c516820d9f78bd63f29dab7d5ec9bc8692064d/kernel/common/hash19.rb#L476-L484">github.com/rubinius/rubinius/blob/98c516820d9f78bd63f29dab7d5ec9bc8692064d/kernel/common/hash19.rb#L476-L484</a></p>
          

          
          <div class="method-source-code" id="keep_if-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 445</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">keep_if</span>( &amp;<span class="ruby-identifier">block</span> )
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">RuntimeError</span>.<span class="ruby-identifier">new</span>( <span class="ruby-node">&quot;can't modify frozen #{ self.class.name }&quot;</span> ) <span class="ruby-keyword">if</span> <span class="ruby-identifier">frozen?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">to_enum</span>( <span class="ruby-value">:keep_if</span> ) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">key</span> , <span class="ruby-identifier">val</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">delete</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">key</span> , <span class="ruby-identifier">val</span> ) }
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- keep_if-source -->
          
        </div>

        

        
      </div><!-- keep_if-method -->

    
      <div id="method-i-key-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">key?</span><span
            class="method-args">(key)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="key-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 348</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">key?</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">super</span>(<span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- key-3F-source -->
          
        </div>

        

        
      </div><!-- key-3F-method -->

    
      <div id="method-i-key_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">key_for</span><span
            class="method-args">(*keys)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="key_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1036</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">key_for</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">key_for</span>(*<span class="ruby-identifier">keys</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- key_for-source -->
          
        </div>

        

        
      </div><!-- key_for-method -->

    
      <div id="method-i-keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">keys</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>instance constructor</p>
          

          
          <div class="method-source-code" id="keys-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 196</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">keys</span>
  <span class="ruby-ivar">@keys</span> <span class="ruby-operator">||=</span> []
<span class="ruby-keyword">end</span></pre>
          </div><!-- keys-source -->
          
        </div>

        

        
      </div><!-- keys-method -->

    
      <div id="method-i-klass" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">klass</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>support methods</p>
          

          
          <div class="method-source-code" id="klass-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 240</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">klass</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- klass-source -->
          
        </div>

        

        
      </div><!-- klass-method -->

    
      <div id="method-i-last" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">last</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="last-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 391</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">last</span>
  [<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">last</span>, <span class="ruby-keyword">self</span>[<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">last</span>]]
<span class="ruby-keyword">end</span></pre>
          </div><!-- last-source -->
          
        </div>

        

        
      </div><!-- last-method -->

    
      <div id="method-i-leaf_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">leaf_for</span><span
            class="method-args">(key, options = {}, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="leaf_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 938</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">leaf_for</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span> = {}, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">leaf</span> = <span class="ruby-keyword">self</span>
  <span class="ruby-identifier">key</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">flatten</span>
  <span class="ruby-identifier">k</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">first</span>

  <span class="ruby-identifier">key</span>.<span class="ruby-identifier">each_cons</span>(<span class="ruby-value">2</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">exists</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_has?</span>(<span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">a</span>)

    <span class="ruby-keyword">case</span> <span class="ruby-identifier">b</span>
      <span class="ruby-keyword">when</span> <span class="ruby-constant">Numeric</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:autovivify</span>]
          <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_set</span>(<span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">a</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">exists</span>
        <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>, <span class="ruby-constant">Symbol</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:autovivify</span>]
          <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_set</span>(<span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">a</span>, <span class="ruby-constant">Map</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">exists</span>
        <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">leaf</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_key</span>(<span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">a</span>)
    <span class="ruby-identifier">k</span> = <span class="ruby-identifier">b</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">block</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">k</span>) <span class="ruby-operator">:</span> [<span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">k</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- leaf_for-source -->
          
        </div>

        

        
      </div><!-- leaf_for-method -->

    
      <div id="method-i-map_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">map_for</span><span
            class="method-args">(hash)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="map_for-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">map_for</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">map_for</span>(<span class="ruby-identifier">hash</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- map_for-source -->
          
        </div>

        

        
      </div><!-- map_for-method -->

    
      <div id="method-i-merge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">merge</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="merge-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 361</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">merge</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">copy</span>.<span class="ruby-identifier">update</span>(*<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- merge-source -->
          
        </div>

        

        
      </div><!-- merge-method -->

    
      <div id="method-i-method_missing" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">method_missing</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>a sane method missing that only supports writing values or reading
*previously set* values</p>
          

          
          <div class="method-source-code" id="method_missing-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 637</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">method_missing</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">method</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">method</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/=$/</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-string">'='</span>)
      <span class="ruby-identifier">value</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
      <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\?$/</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-string">'?'</span>)
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">has?</span>( <span class="ruby-identifier">key</span> )
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-identifier">method</span>
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">key</span>)
        <span class="ruby-keyword">return</span>(<span class="ruby-identifier">block</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">key</span>, &amp;<span class="ruby-identifier">block</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">super</span>(*<span class="ruby-identifier">args</span>))
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- method_missing-source -->
          
        </div>

        

        
      </div><!-- method_missing-method -->

    
      <div id="method-i-mongoize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">mongoize</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="mongoize-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1170</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mongoize</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- mongoize-source -->
          
        </div>

        

        
      </div><!-- mongoize-method -->

    
      <div id="method-i-name_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">name_for</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="name_for-source">
            <pre><span class="ruby-comment"># File lib/map/params.rb, line 26</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">name_for</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">options_for!</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:value</span>] = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">param_for</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- name_for-source -->
          
        </div>

        

        
      </div><!-- name_for-method -->

    
      <div id="method-i-param_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">param_for</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="param_for-source">
            <pre><span class="ruby-comment"># File lib/map/params.rb, line 2</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">param_for</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">options_for!</span>(<span class="ruby-identifier">args</span>)

  <span class="ruby-identifier">prefix</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:prefix</span>] <span class="ruby-operator">||</span> <span class="ruby-string">'map'</span>

  <span class="ruby-identifier">src_key</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-constant">Map</span>.<span class="ruby-identifier">alphanumeric_key_for</span>(<span class="ruby-identifier">arg</span>)}

  <span class="ruby-identifier">dst_key</span> = <span class="ruby-identifier">src_key</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Numeric</span>) <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">k</span>}

  <span class="ruby-identifier">src</span> = <span class="ruby-keyword">self</span>
  <span class="ruby-identifier">dst</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">value</span> =
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:value</span>)
      <span class="ruby-identifier">options</span>[<span class="ruby-value">:value</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">src</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">src_key</span>).<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">dst</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">dst_key</span>, <span class="ruby-identifier">value</span>)

  <span class="ruby-constant">Param</span>.<span class="ruby-identifier">param_for</span>(<span class="ruby-identifier">dst</span>, <span class="ruby-identifier">prefix</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- param_for-source -->
          
        </div>

        

        
      </div><!-- param_for-method -->

    
      <div id="method-i-pop" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pop</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="pop-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 487</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pop</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
    [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pop-source -->
          
        </div>

        

        
      </div><!-- pop-method -->

    
      <div id="method-i-push" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">push</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="push-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 477</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">push</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">each_pair</span>(*<span class="ruby-identifier">args</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">__set__</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- push-source -->
          
        </div>

        

        
      </div><!-- push-method -->

    
      <div id="method-i-reject" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reject</span><span
            class="method-args">(&block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="reject-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 550</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reject</span>(&amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">delete_if</span>(&amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- reject-source -->
          
        </div>

        

        
      </div><!-- reject-method -->

    
      <div id="method-i-reject-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reject!</span><span
            class="method-args">(&block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="reject-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 554</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reject!</span>(&amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">reject</span>(&amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">hash</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">hash</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- reject-21-source -->
          
        </div>

        

        
      </div><!-- reject-21-method -->

    
      <div id="method-i-reorder" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reorder</span><span
            class="method-args">(order = {})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>reordering support</p>
          

          
          <div class="method-source-code" id="reorder-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 523</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reorder</span>(<span class="ruby-identifier">order</span> = {})
  <span class="ruby-identifier">order</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">order</span>)
  <span class="ruby-identifier">map</span> = <span class="ruby-constant">Map</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">order</span>.<span class="ruby-identifier">depth_first_keys</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">depth_first_keys</span>
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">map</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">get</span>(<span class="ruby-identifier">key</span>))}
  <span class="ruby-identifier">map</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- reorder-source -->
          
        </div>

        

        
      </div><!-- reorder-method -->

    
      <div id="method-i-reorder-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reorder!</span><span
            class="method-args">(order = {})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="reorder-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 531</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reorder!</span>(<span class="ruby-identifier">order</span> = {})
  <span class="ruby-identifier">replace</span>(<span class="ruby-identifier">reorder</span>(<span class="ruby-identifier">order</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- reorder-21-source -->
          
        </div>

        

        
      </div><!-- reorder-21-method -->

    
      <div id="method-i-replace" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">replace</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="replace-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 452</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">replace</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">update</span>(*<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- replace-source -->
          
        </div>

        

        
      </div><!-- replace-method -->

    
      <div id="method-i-respond_to-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">respond_to?</span><span
            class="method-args">(method, *args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="respond_to-3F-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 656</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">has_key</span> = <span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">method</span>)
  <span class="ruby-identifier">setter</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/=\Z/</span>
  <span class="ruby-operator">!</span><span class="ruby-operator">!</span>((<span class="ruby-operator">!</span><span class="ruby-identifier">has_key</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">setter</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">has_key</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">super</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- respond_to-3F-source -->
          
        </div>

        

        
      </div><!-- respond_to-3F-method -->

    
      <div id="method-i-reverse_merge" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reverse_merge</span><span
            class="method-args">(hash)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="reverse_merge-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 366</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reverse_merge</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">map</span> = <span class="ruby-identifier">copy</span>
  <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">map</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">val</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">map</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">key</span>)}
  <span class="ruby-identifier">map</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- reverse_merge-source -->
          
        </div>

        

        
      </div><!-- reverse_merge-method -->

    
      <div id="method-i-reverse_merge-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reverse_merge!</span><span
            class="method-args">(hash)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="reverse_merge-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 372</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reverse_merge!</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-identifier">replace</span>(<span class="ruby-identifier">reverse_merge</span>(<span class="ruby-identifier">hash</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- reverse_merge-21-source -->
          
        </div>

        

        
      </div><!-- reverse_merge-21-method -->

    
      <div id="method-i-rm" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rm</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="rm-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 965</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rm</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">paths</span>, <span class="ruby-identifier">path</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">partition</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)}
  <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">path</span>)

  <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">delete</span>(*<span class="ruby-identifier">p</span>)
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">branch</span>, <span class="ruby-identifier">leaf</span> = <span class="ruby-identifier">p</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>], <span class="ruby-identifier">p</span>[<span class="ruby-value">-1</span>]
    <span class="ruby-identifier">collection</span> = <span class="ruby-identifier">get</span>(<span class="ruby-identifier">branch</span>)

    <span class="ruby-keyword">case</span> <span class="ruby-identifier">collection</span>
      <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
        <span class="ruby-identifier">key</span> = <span class="ruby-identifier">leaf</span>
        <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
      <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
        <span class="ruby-identifier">index</span> = <span class="ruby-identifier">leaf</span>
        <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-identifier">index</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">raise</span>(<span class="ruby-constant">IndexError</span>, <span class="ruby-node">&quot;(#{ collection.inspect }).rm(#{ p.inspect })&quot;</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">paths</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- rm-source -->
          
        </div>

        

        
      </div><!-- rm-method -->

    
      <div id="method-i-select" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">select</span><span
            class="method-args">() { |key, val| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="select-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 559</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">select</span>
  <span class="ruby-identifier">array</span> = []
  <span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">array</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>,<span class="ruby-identifier">val</span>] <span class="ruby-keyword">if</span> <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)}
  <span class="ruby-identifier">array</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- select-source -->
          
        </div>

        

        
      </div><!-- select-method -->

    
      <div id="method-i-serialize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">serialize</span><span
            class="method-args">(object)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>for mongoid type system support</p>
          

          
          <div class="method-source-code" id="serialize-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 1154</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">serialize</span>(<span class="ruby-identifier">object</span>)
  <span class="ruby-operator">::</span><span class="ruby-constant">Map</span>.<span class="ruby-identifier">for</span>(<span class="ruby-identifier">object</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- serialize-source -->
          
        </div>

        

        
      </div><!-- serialize-method -->

    
      <div id="method-i-set" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="set-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 822</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">case</span>
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-keyword">return</span> []
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">hash</span> = {}
      <span class="ruby-identifier">value</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">args</span>).<span class="ruby-identifier">flatten</span>
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">strategy</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">skey</span>, <span class="ruby-identifier">svalue</span><span class="ruby-operator">|</span> [<span class="ruby-constant">Array</span>(<span class="ruby-identifier">skey</span>), <span class="ruby-identifier">svalue</span>]}

  <span class="ruby-identifier">strategy</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">skey</span>, <span class="ruby-identifier">svalue</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">leaf_for</span>(<span class="ruby-identifier">skey</span>, <span class="ruby-value">:autovivify</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">k</span><span class="ruby-operator">|</span>
      <span class="ruby-constant">Map</span>.<span class="ruby-identifier">collection_set</span>(<span class="ruby-identifier">leaf</span>, <span class="ruby-identifier">k</span>, <span class="ruby-identifier">svalue</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- set-source -->
          
        </div>

        

        
      </div><!-- set-method -->

    
      <div id="method-i-shift" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">shift</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>ordered container specific methods</p>
          

          
          <div class="method-source-code" id="shift-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 459</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">shift</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
    [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- shift-source -->
          
        </div>

        

        
      </div><!-- shift-method -->

    
      <div id="method-i-stringify_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stringify_keys</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="stringify_keys-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 626</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stringify_keys</span>; <span class="ruby-identifier">dup</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- stringify_keys-source -->
          
        </div>

        

        
      </div><!-- stringify_keys-method -->

    
      <div id="method-i-stringify_keys-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stringify_keys!</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>oh rails - would that map.rb existed before all this non-sense</p>
          

          
          <div class="method-source-code" id="stringify_keys-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 625</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stringify_keys!</span>; <span class="ruby-keyword">self</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- stringify_keys-21-source -->
          
        </div>

        

        
      </div><!-- stringify_keys-21-method -->

    
      <div id="method-i-struct" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">struct</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="struct-source">
            <pre><span class="ruby-comment"># File lib/map/struct.rb, line 45</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">struct</span>
  <span class="ruby-ivar">@struct</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- struct-source -->
          
        </div>

        

        
      </div><!-- struct-method -->

    
      <div id="method-i-symbolize_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">symbolize_keys</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="symbolize_keys-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 628</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">symbolize_keys</span>; <span class="ruby-identifier">dup</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- symbolize_keys-source -->
          
        </div>

        

        
      </div><!-- symbolize_keys-method -->

    
      <div id="method-i-symbolize_keys-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">symbolize_keys!</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="symbolize_keys-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 627</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">symbolize_keys!</span>; <span class="ruby-keyword">self</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- symbolize_keys-21-source -->
          
        </div>

        

        
      </div><!-- symbolize_keys-21-method -->

    
      <div id="method-i-to_array" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_array</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_array-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 604</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_array</span>
  <span class="ruby-identifier">array</span> = []
  <span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span>*<span class="ruby-identifier">pair</span><span class="ruby-operator">|</span> <span class="ruby-identifier">array</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">pair</span>)}
  <span class="ruby-identifier">array</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_array-source -->
          
        </div>

        

        
      </div><!-- to_array-method -->

    
      <div id="method-i-to_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_hash</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_hash-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 588</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_hash</span>
  <span class="ruby-identifier">hash</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">default</span>)
  <span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">val</span> = <span class="ruby-identifier">val</span>.<span class="ruby-identifier">to_hash</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">val</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">hash</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_hash-source -->
          
        </div>

        

        
      </div><!-- to_hash-method -->

    
      <div id="method-i-to_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_list</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_list-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 611</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_list</span>
  <span class="ruby-identifier">list</span> = []
  <span class="ruby-identifier">each_pair</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">list</span>[<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_i</span>] = <span class="ruby-identifier">val</span> <span class="ruby-keyword">if</span>(<span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Numeric</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\d+$/</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">list</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_list-source -->
          
        </div>

        

        
      </div><!-- to_list-method -->

    
      <div id="method-i-to_options" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_options</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_options-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 630</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_options</span>; <span class="ruby-identifier">dup</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- to_options-source -->
          
        </div>

        

        
      </div><!-- to_options-method -->

    
      <div id="method-i-to_options-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_options!</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_options-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 629</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_options!</span>; <span class="ruby-keyword">self</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- to_options-21-source -->
          
        </div>

        

        
      </div><!-- to_options-21-method -->

    
      <div id="method-i-to_params" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_params</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_params-source">
            <pre><span class="ruby-comment"># File lib/map/params.rb, line 33</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_params</span>
  <span class="ruby-identifier">to_params</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">depth_first_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">to_params</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">param_for</span>(<span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">to_params</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">'&amp;'</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_params-source -->
          
        </div>

        

        
      </div><!-- to_params-method -->

    
      <div id="method-i-to_s" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_s-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 619</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">to_array</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_s-source -->
          
        </div>

        

        
      </div><!-- to_s-method -->

    
      <div id="method-i-to_yaml" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_yaml</span><span
            class="method-args">( opts = {} )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="to_yaml-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 597</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_yaml</span>( <span class="ruby-identifier">opts</span> = {} )
  <span class="ruby-identifier">map</span> = <span class="ruby-keyword">self</span>
  <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">quick_emit</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">object_id</span>, <span class="ruby-identifier">opts</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">out</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">out</span>.<span class="ruby-identifier">map</span>(<span class="ruby-string">'!omap'</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">map</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>)}}
  }
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_yaml-source -->
          
        </div>

        

        
      </div><!-- to_yaml-method -->

    
      <div id="method-i-unshift" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unshift</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="unshift-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 467</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unshift</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">each_pair</span>(*<span class="ruby-identifier">args</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-identifier">convert_key</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">__set__</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- unshift-source -->
          
        </div>

        

        
      </div><!-- unshift-method -->

    
      <div id="method-i-update" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update</span><span
            class="method-args">(*args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="update-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 355</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>(*<span class="ruby-identifier">args</span>)
  <span class="ruby-constant">Map</span>.<span class="ruby-identifier">each_pair</span>(*<span class="ruby-identifier">args</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">store</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- update-source -->
          
        </div>

        

        
      </div><!-- update-method -->

    
      <div id="method-i-values" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">values</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="values-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 376</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">values</span>
  <span class="ruby-identifier">array</span> = []
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">array</span>.<span class="ruby-identifier">push</span>(<span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>])}
  <span class="ruby-identifier">array</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- values-source -->
          
        </div>

        

        
      </div><!-- values-method -->

    
      <div id="method-i-values_at" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">values_at</span><span
            class="method-args">(*keys)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="values_at-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 383</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">values_at</span>(*<span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">keys</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-keyword">self</span>[<span class="ruby-identifier">key</span>]}
<span class="ruby-keyword">end</span></pre>
          </div><!-- values_at-source -->
          
        </div>

        

        
      </div><!-- values_at-method -->

    
      <div id="method-i-with_indifferent_access" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">with_indifferent_access</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="with_indifferent_access-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 632</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_indifferent_access</span>; <span class="ruby-identifier">dup</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- with_indifferent_access-source -->
          
        </div>

        

        
      </div><!-- with_indifferent_access-method -->

    
      <div id="method-i-with_indifferent_access-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">with_indifferent_access!</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="with_indifferent_access-21-source">
            <pre><span class="ruby-comment"># File lib/map.rb, line 631</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">with_indifferent_access!</span>; <span class="ruby-keyword">self</span> <span class="ruby-keyword">end</span></pre>
          </div><!-- with_indifferent_access-21-source -->
          
        </div>

        

        
      </div><!-- with_indifferent_access-21-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.2.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

